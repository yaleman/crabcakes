function C(){let t={};document.querySelectorAll(".form-control").forEach(e=>{t[e.id]=e.value}),fetch("/admin/api/policy_troubleshooter",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)}).then(e=>e.json()).then(e=>{console.log("Policy check result:",e);let n=document.getElementById("results");if(!n)return;for(;n.firstChild;)n.removeChild(n.firstChild);let i=document.createElement("h3");i.innerHTML=`Decision: <span class="badge badge-${e.decision.toLowerCase()}">${e.decision}</span>`,n.appendChild(i);let c=document.createElement("p");c.textContent=`Reason: ${e.reason}`,n.appendChild(c);let l=document.createElement("h4");l.textContent="Deny Policies:",n.appendChild(l);let r=document.createElement("ul");e.deny_policies.forEach(a=>{let o=document.createElement("li");o.textContent=a,r.appendChild(o)}),n.appendChild(r);let p=document.createElement("h4");p.textContent="Allow Policies:",n.appendChild(p);let h=document.createElement("ul");e.allow_policies.forEach(a=>{let o=document.createElement("li");o.textContent=a,h.appendChild(o)}),n.appendChild(h);let m=document.createElement("h4");m.textContent="Not Applicable Policies:",n.appendChild(m);let u=document.createElement("ul");e.not_applicable_policies.forEach(a=>{let o=document.createElement("li");o.textContent=a,u.appendChild(o)}),n.appendChild(u)}).catch(e=>{console.error("Error checking policy:",e);let n=document.getElementById("results");if(!n)return;for(;n.firstChild;)n.removeChild(n.firstChild);let i=document.createElement("div");i.className="error-container";let c=document.createElement("h1");c.textContent="Error checking policy. Please try again.",i.appendChild(c);let l=document.createElement("p");l.textContent=e.toString(),i.appendChild(l),n.appendChild(i)})}var s=0;function d(t){t?console.debug("Debounce timer is still running. Waiting for it to expire."):t=window.setTimeout(()=>{t=0,C()},300)}document.querySelectorAll(" .form-control").forEach(t=>{t.addEventListener("input",()=>{console.debug(`Input changed: ${t.id} = ${t.value}`);let e=new URL(window.location.href);e.searchParams.set(t.id,t.value),console.debug(`Updated URL: ${e.toString()}`),window.history.pushState({},"",e),d(s)})});document.getElementsByName("check_access").forEach(t=>{t.addEventListener("click",e=>{e.preventDefault(),d(s)}),t.addEventListener("submit",e=>{e.preventDefault(),d(s)})});window.addEventListener("load",()=>{let t=!1;document.querySelectorAll(".form-control").forEach(e=>{e.value&&(t=!0)}),t&&d(s)});
