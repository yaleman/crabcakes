function f(){var t={};document.querySelectorAll(".form-control").forEach(function(e){t[e.id]=e.value}),fetch("/admin/api/policy_troubleshooter",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)}).then(function(e){return e.json()}).then(function(e){console.log("Policy check result:",e);var n=document.getElementById("results");if(n){for(;n.firstChild;)n.removeChild(n.firstChild);var i=document.createElement("h3");i.innerHTML='Decision: <span class="badge badge-'.concat(e.decision.toLowerCase(),'">').concat(e.decision,"</span>"),n.appendChild(i);var c=document.createElement("p");c.textContent="Reason: ".concat(e.reason),n.appendChild(c);var a=document.createElement("h4");a.textContent="Deny Policies:",n.appendChild(a);var s=document.createElement("ul");e.deny_policies.forEach(function(l){var o=document.createElement("li");o.textContent=l,s.appendChild(o)}),n.appendChild(s);var u=document.createElement("h4");u.textContent="Allow Policies:",n.appendChild(u);var h=document.createElement("ul");e.allow_policies.forEach(function(l){var o=document.createElement("li");o.textContent=l,h.appendChild(o)}),n.appendChild(h);var m=document.createElement("h4");m.textContent="Not Applicable Policies:",n.appendChild(m);var p=document.createElement("ul");e.not_applicable_policies.forEach(function(l){var o=document.createElement("li");o.textContent=l,p.appendChild(o)}),n.appendChild(p)}}).catch(function(e){console.error("Error checking policy:",e);var n=document.getElementById("results");if(n){for(;n.firstChild;)n.removeChild(n.firstChild);var i=document.createElement("div");i.className="error-container";var c=document.createElement("h1");c.textContent="Error checking policy. Please try again.",i.appendChild(c);var a=document.createElement("p");a.textContent=e.toString(),i.appendChild(a),n.appendChild(i)}})}var r=0;function d(t){t?console.debug("Debounce timer is still running. Waiting for it to expire."):t=window.setTimeout(function(){t=0,f()},300)}document.querySelectorAll(".form-control").forEach(function(t){t.addEventListener("input",function(){console.debug("Input changed: ".concat(t.id," = ").concat(t.value));var e=new URL(window.location.href);e.searchParams.set(t.id,t.value),console.debug("Updated URL: ".concat(e.toString())),window.history.pushState({},"",e),d(r)})});document.getElementsByName("check_access").forEach(function(t){t.addEventListener("click",function(e){e.preventDefault(),d(r)}),t.addEventListener("submit",function(e){e.preventDefault(),d(r)})});window.addEventListener("load",function(){var t=!1;document.querySelectorAll(".form-control").forEach(function(e){e.value&&(t=!0)}),t&&d(r)});
