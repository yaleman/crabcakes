function y(o,c,r,t,e,i,a){try{var u=o[i](a),f=u.value}catch(n){r(n);return}u.done?c(f):Promise.resolve(f).then(t,e)}function p(o){return function(){var c=this,r=arguments;return new Promise(function(t,e){var i=o.apply(c,r);function a(f){y(i,t,e,a,u,"next",f)}function u(f){y(i,t,e,a,u,"throw",f)}a(void 0)})}}function g(o,c,r){return c in o?Object.defineProperty(o,c,{value:r,enumerable:!0,configurable:!0,writable:!0}):o[c]=r,o}function b(o){for(var c=1;c<arguments.length;c++){var r=arguments[c]!=null?arguments[c]:{},t=Object.keys(r);typeof Object.getOwnPropertySymbols=="function"&&(t=t.concat(Object.getOwnPropertySymbols(r).filter(function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable}))),t.forEach(function(e){g(o,e,r[e])})}return o}function O(o,c){var r=Object.keys(o);if(Object.getOwnPropertySymbols){var t=Object.getOwnPropertySymbols(o);c&&(t=t.filter(function(e){return Object.getOwnPropertyDescriptor(o,e).enumerable})),r.push.apply(r,t)}return r}function h(o,c){return c=c??{},Object.getOwnPropertyDescriptors?Object.defineProperties(o,Object.getOwnPropertyDescriptors(c)):O(Object(c)).forEach(function(r){Object.defineProperty(o,r,Object.getOwnPropertyDescriptor(c,r))}),o}function w(o){"@swc/helpers - typeof";return o&&typeof Symbol<"u"&&o.constructor===Symbol?"symbol":typeof o}function d(o,c){var r,t,e,i={label:0,sent:function(){if(e[0]&1)throw e[1];return e[1]},trys:[],ops:[]},a=Object.create((typeof Iterator=="function"?Iterator:Object).prototype);return a.next=u(0),a.throw=u(1),a.return=u(2),typeof Symbol=="function"&&(a[Symbol.iterator]=function(){return this}),a;function u(n){return function(l){return f([n,l])}}function f(n){if(r)throw new TypeError("Generator is already executing.");for(;a&&(a=0,n[0]&&(i=0)),i;)try{if(r=1,t&&(e=n[0]&2?t.return:n[0]?t.throw||((e=t.return)&&e.call(t),0):t.next)&&!(e=e.call(t,n[1])).done)return e;switch(t=0,e&&(n=[n[0]&2,e.value]),n[0]){case 0:case 1:e=n;break;case 4:return i.label++,{value:n[1],done:!1};case 5:i.label++,t=n[1],n=[0];continue;case 7:n=i.ops.pop(),i.trys.pop();continue;default:if(e=i.trys,!(e=e.length>0&&e[e.length-1])&&(n[0]===6||n[0]===2)){i=0;continue}if(n[0]===3&&(!e||n[1]>e[0]&&n[1]<e[3])){i.label=n[1];break}if(n[0]===6&&i.label<e[1]){i.label=e[1],e=n;break}if(e&&i.label<e[2]){i.label=e[2],i.ops.push(n);break}e[2]&&i.ops.pop(),i.trys.pop();continue}n=c.call(o,i)}catch(l){n=[6,l],t=0}finally{r=e=0}if(n[0]&5)throw n[1];return{value:n[0]?n[1]:void 0,done:!0}}}var s=null;function m(){return p(function(){var o,c,r;return d(this,function(t){switch(t.label){case 0:if(s)return[2,s];t.label=1;case 1:return t.trys.push([1,4,,5]),[4,fetch("/admin/api/csrf-token")];case 2:if(o=t.sent(),!o.ok)throw new Error("Failed to fetch CSRF token");return[4,o.json()];case 3:return c=t.sent(),s=c.csrf_token,[2,s];case 4:throw r=t.sent(),console.error("Error fetching CSRF token:",r),r;case 5:return[2]}})})()}function v(o){return p(function(c){var r,t,e,i=arguments;return d(this,function(a){switch(a.label){case 0:return r=i.length>1&&i[1]!==void 0?i[1]:{},[4,m()];case 1:return t=a.sent(),e=h(b({},r.headers),{"X-CSRF-Token":t}),r.body&&w(r.body)==="object"&&(e["Content-Type"]="application/json",r.body=JSON.stringify(r.body)),[2,fetch(c,h(b({},r),{headers:e}))]}})}).apply(this,arguments)}export{v as authenticatedFetch,m as getCsrfToken};
