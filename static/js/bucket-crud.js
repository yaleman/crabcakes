function g(u,o,c,r,e,n,a){try{var i=u[n](a),s=i.value}catch(t){c(t);return}i.done?o(s):Promise.resolve(s).then(r,e)}function k(u){return function(){var o=this,c=arguments;return new Promise(function(r,e){var n=u.apply(o,c);function a(s){g(n,r,e,a,i,"next",s)}function i(s){g(n,r,e,a,i,"throw",s)}a(void 0)})}}function P(u,o,c){return o in u?Object.defineProperty(u,o,{value:c,enumerable:!0,configurable:!0,writable:!0}):u[o]=c,u}function p(u){for(var o=1;o<arguments.length;o++){var c=arguments[o]!=null?arguments[o]:{},r=Object.keys(c);typeof Object.getOwnPropertySymbols=="function"&&(r=r.concat(Object.getOwnPropertySymbols(c).filter(function(e){return Object.getOwnPropertyDescriptor(c,e).enumerable}))),r.forEach(function(e){P(u,e,c[e])})}return u}function x(u,o){var c=Object.keys(u);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(u);o&&(r=r.filter(function(e){return Object.getOwnPropertyDescriptor(u,e).enumerable})),c.push.apply(c,r)}return c}function w(u,o){return o=o??{},Object.getOwnPropertyDescriptors?Object.defineProperties(u,Object.getOwnPropertyDescriptors(o)):x(Object(o)).forEach(function(c){Object.defineProperty(u,c,Object.getOwnPropertyDescriptor(o,c))}),u}function B(u){"@swc/helpers - typeof";return u&&typeof Symbol<"u"&&u.constructor===Symbol?"symbol":typeof u}function E(u,o){var c,r,e,n={label:0,sent:function(){if(e[0]&1)throw e[1];return e[1]},trys:[],ops:[]},a=Object.create((typeof Iterator=="function"?Iterator:Object).prototype);return a.next=i(0),a.throw=i(1),a.return=i(2),typeof Symbol=="function"&&(a[Symbol.iterator]=function(){return this}),a;function i(t){return function(l){return s([t,l])}}function s(t){if(c)throw new TypeError("Generator is already executing.");for(;a&&(a=0,t[0]&&(n=0)),n;)try{if(c=1,r&&(e=t[0]&2?r.return:t[0]?r.throw||((e=r.return)&&e.call(r),0):r.next)&&!(e=e.call(r,t[1])).done)return e;switch(r=0,e&&(t=[t[0]&2,e.value]),t[0]){case 0:case 1:e=t;break;case 4:return n.label++,{value:t[1],done:!1};case 5:n.label++,r=t[1],t=[0];continue;case 7:t=n.ops.pop(),n.trys.pop();continue;default:if(e=n.trys,!(e=e.length>0&&e[e.length-1])&&(t[0]===6||t[0]===2)){n=0;continue}if(t[0]===3&&(!e||t[1]>e[0]&&t[1]<e[3])){n.label=t[1];break}if(t[0]===6&&n.label<e[1]){n.label=e[1],e=t;break}if(e&&n.label<e[2]){n.label=e[2],n.ops.push(t);break}e[2]&&n.ops.pop(),n.trys.pop();continue}t=o.call(u,n)}catch(l){t=[6,l],r=0}finally{c=e=0}if(t[0]&5)throw t[1];return{value:t[0]?t[1]:void 0,done:!0}}}var b=null;function C(){return k(function(){var u,o,c;return E(this,function(r){switch(r.label){case 0:if(b)return[2,b];r.label=1;case 1:return r.trys.push([1,4,,5]),[4,fetch("/admin/api/csrf-token")];case 2:if(u=r.sent(),!u.ok)throw new Error("Failed to fetch CSRF token");return[4,u.json()];case 3:return o=r.sent(),b=o.csrf_token,[2,b];case 4:throw c=r.sent(),console.error("Error fetching CSRF token:",c),c;case 5:return[2]}})})()}function h(u){return k(function(o){var c,r,e,n=arguments;return E(this,function(a){switch(a.label){case 0:return c=n.length>1&&n[1]!==void 0?n[1]:{},[4,C()];case 1:return r=a.sent(),e=w(p({},c.headers),{"X-CSRF-Token":r}),c.body&&B(c.body)==="object"&&(e["Content-Type"]="application/json",c.body=JSON.stringify(c.body)),[2,fetch(o,w(p({},c),{headers:e}))]}})}).apply(this,arguments)}function O(u,o,c,r,e,n,a){try{var i=u[n](a),s=i.value}catch(t){c(t);return}i.done?o(s):Promise.resolve(s).then(r,e)}function m(u){return function(){var o=this,c=arguments;return new Promise(function(r,e){var n=u.apply(o,c);function a(s){O(n,r,e,a,i,"next",s)}function i(s){O(n,r,e,a,i,"throw",s)}a(void 0)})}}function j(u,o){return o!=null&&typeof Symbol<"u"&&o[Symbol.hasInstance]?!!o[Symbol.hasInstance](u):u instanceof o}function y(u,o){var c,r,e,n={label:0,sent:function(){if(e[0]&1)throw e[1];return e[1]},trys:[],ops:[]},a=Object.create((typeof Iterator=="function"?Iterator:Object).prototype);return a.next=i(0),a.throw=i(1),a.return=i(2),typeof Symbol=="function"&&(a[Symbol.iterator]=function(){return this}),a;function i(t){return function(l){return s([t,l])}}function s(t){if(c)throw new TypeError("Generator is already executing.");for(;a&&(a=0,t[0]&&(n=0)),n;)try{if(c=1,r&&(e=t[0]&2?r.return:t[0]?r.throw||((e=r.return)&&e.call(r),0):r.next)&&!(e=e.call(r,t[1])).done)return e;switch(r=0,e&&(t=[t[0]&2,e.value]),t[0]){case 0:case 1:e=t;break;case 4:return n.label++,{value:t[1],done:!1};case 5:n.label++,r=t[1],t=[0];continue;case 7:t=n.ops.pop(),n.trys.pop();continue;default:if(e=n.trys,!(e=e.length>0&&e[e.length-1])&&(t[0]===6||t[0]===2)){n=0;continue}if(t[0]===3&&(!e||t[1]>e[0]&&t[1]<e[3])){n.label=t[1];break}if(t[0]===6&&n.label<e[1]){n.label=e[1],e=t;break}if(e&&n.label<e[2]){n.label=e[2],n.ops.push(t);break}e[2]&&n.ops.pop(),n.trys.pop();continue}t=o.call(u,n)}catch(l){t=[6,l],r=0}finally{c=e=0}if(t[0]&5)throw t[1];return{value:t[0]?t[1]:void 0,done:!0}}}function D(u){return m(function(){var o,c,r,e;return y(this,function(n){switch(n.label){case 0:return n.trys.push([0,5,,6]),[4,h("/admin/api/buckets",{method:"POST",body:JSON.stringify({bucket_name:u}),headers:{"Content-Type":"application/json"}})];case 1:return o=n.sent(),o.ok?[3,3]:[4,o.text()];case 2:throw c=n.sent(),new Error("Failed to create bucket: ".concat(c));case 3:return[4,o.json()];case 4:return r=n.sent(),[2,r];case 5:throw e=n.sent(),console.error("Error creating bucket:",e),e;case 6:return[2]}})})()}function F(){var u=document.getElementById("bucket-form");u&&u.addEventListener("submit",function(o){return m(function(){var c,r,e,n;return y(this,function(a){switch(a.label){case 0:o.preventDefault(),c=document.getElementById("bucket-name"),r=c.value,a.label=1;case 1:return a.trys.push([1,3,,4]),[4,D(r)];case 2:return a.sent(),window.location.href="/admin/buckets/".concat(r),[3,4];case 3:return e=a.sent(),n=j(e,Error)?e.message:String(e),I(n),[3,4];case 4:return[2]}})})()})}function I(u){var o=document.getElementById("bucket-form")||document.getElementById("bucket-delete-form");if(o){var c=o.querySelector(".error-message");c&&c.remove();var r=document.createElement("div");r.className="error-message",r.textContent="Error: ".concat(u),o.insertBefore(r,o.firstChild)}}function T(u){var o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;return m(function(){var c,r,e,n,a;return y(this,function(i){switch(i.label){case 0:return i.trys.push([0,5,,6]),c=o?"/admin/api/buckets/".concat(u,"?force=true"):"/admin/api/buckets/".concat(u),[4,h(c,{method:"DELETE"})];case 1:return r=i.sent(),r.ok?[3,3]:[4,r.text()];case 2:throw e=i.sent(),new Error("Failed to delete bucket: ".concat(e));case 3:return[4,r.json()];case 4:return n=i.sent(),[2,n];case 5:throw a=i.sent(),console.error("Error deleting bucket:",a),a;case 6:return[2]}})})()}function _(){var u=document.getElementById("bucket-delete-form");if(!u)return;var o=document.getElementById("bucket-name"),c=o.value,r=document.getElementById("object-count"),e=parseInt(r.value,10),n=document.getElementById("confirm-bucket-name"),a=document.getElementById("confirm-delete-objects"),i=document.getElementById("delete-btn");function s(){var t=n.value===c,l=e===0||a&&a.checked;i.disabled=!(t&&l)}n.addEventListener("input",s),a&&a.addEventListener("change",s),u.addEventListener("submit",function(t){return m(function(){var l,d,v;return y(this,function(f){switch(f.label){case 0:t.preventDefault(),f.label=1;case 1:return f.trys.push([1,3,,4]),l=e>0,[4,T(c,l)];case 2:return f.sent(),window.location.href="/admin/buckets",[3,4];case 3:return d=f.sent(),v=j(d,Error)?d.message:String(d),I(v),[3,4];case 4:return[2]}})})()})}function S(){F(),_()}document.readyState==="loading"?document.addEventListener("DOMContentLoaded",S):S();
